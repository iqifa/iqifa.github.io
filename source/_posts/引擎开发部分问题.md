---
title: 引擎开发部分问题
date: 2024-12-02 23:35:20
categories: [引擎]
---
开发的时候的一些注意事项^_^

#### IMGUI

imgui在Core中，但是却不能在Sandbox中调用，出现无法解析的外部符号，因为Core作为DLL时，imgui也需要导出才能在Sandbox中使用，因此IMGUI提供了IMGUI_API宏，在imguiconfig.h中设置

```C++
#define IMGUI_API __declspec( dllexport )
```

或者在Sandbox和Core的Premake5.lua中设置

```lua
defines{"IMGUI_API=__declspec( dllexport )"}
```

这就引出下面这个问题

#### c++dll导出符号

__declspec( dllexport )和__declspec( dllimport )，一般来说由dllexport 标记导出，dllimport 标记导入，在c++中
使用如下所示，在项目中定义 `T_BUILD_DLL`的情况下导出标记对象，否则导入标记对象

```c++
#ifdef T_BUILD_DLL
#define IMGUI_API __declspec( dllexport )
#else
#define IMGUI_API __declspec( dllimport )
#endif // T_BUILD_DLL

class IMGUI_API Test{};
```

但是，实际项目中会发现，不使用`dllimport `也可以导入对象，如下

```c++
#ifdef T_BUILD_DLL
#define IMGUI_API __declspec( dllexport )
#else
#endif // T_BUILD_DLL
```

实际上 `dllimport `并不只是用于导入标记，在类内部存在静态变量时，如果没有`dllimport `就会出现无法解析的符号，

```c++
class IMGUI_API Test {

public:
    const static int a = 0;
};
```

如此，如果在外部调用dll中的静态变量或者方法就会出现错误。

#### APIENTRY重定义

一般调用GLFW时会出现这个，解决方法就是在GLFW之前调用`windows.h`

```c++
#include"Windows.h"

#include<GL/glew.h>
#include <GLFW/glfw3.h>
```

这个时候会出现一个问题，byte重定义，**重点来了**，因为在`window.h`之前调用了`namespace std`所以报错，之后在整个项目中极少在头文件中使用`using namespace std`